- ~~The txn can't take a lock over the entire duration of the Lock method because it prevents the txn from acquiring locks on other resources.~~ A txn should be able to acquire locks on multiple resources simultaneously.
	- It's because the txn can be aborted. Aborting the txn requires acquiring locks on it. (It also calls Unlock method which would acquire a lock for erasing lock sets)
	- What if we only lock the txn when updating the lock sets?
- See this note: https://cs186berkeley.net/notes/note12/
	- Would adding to queue be technically similar to waiting using a condition variable?
- Granting new locks in the Lock methods interferes with the FIFO order since the caller of the Lock methods doesn't get the acknowledgement of the Lock being granted until all the other locks in queue are granted (& so on).
- If the lock request queue is empty, we don't need to wait using the condition variable.
- Note that we can only allow an Exclusive lock if no Shared or Exclusive locks are already granted for the resource.
- Do we wait just before granting the lock or do we wait before all the validation checks?
- If we're holding a latch on the lock request queue for a resource, why do we need to check if multiple txn are upgrading on that resource?
	- Note that the wait method for condition_variable releases the lock. So we aren't holding the lock & multiple txns can attempt upgrades.
- We aren't creating any new lock request for lock upgrades which is unexpected. We're just upgrading the lock. Should it be like this?
- The txn need to drop the lower level lock before being granted a higher level lock. (level -> granularity of the lock)
	- But in 2PL, once a lock is released, the txn goes into a "Shrinking" phase & new locks can't be acquired any longer.
		- This varies as per isolation level & the lock mode (shared or exclusive)
- Cycle Detection
	- Topological Sort w/ Kahn's detection algorithm
	- A txn has a dependency if it has an un-granted lock request not compatible with a lock request from another txn (that's granted) on the same resource.